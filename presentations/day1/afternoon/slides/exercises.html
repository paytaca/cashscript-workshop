<section>
    <h2><div class="text-green-300">Exercise</div></h2>
</section>

<section>
    <h2><div class="text-green-300">Exercise</div></h2>
    <div class="text-center text-2xl">Fund Raiser Contract </div>
    <code lang data-trim>
        pragma cashscript ^0.11.0;

        contract FundRaiserSimpleExercise(pubkey campaignCreatorPubKey, int campaignGoal) {

            function claimFunds(sig claimerSig) {

                // 1. Verify that the claimer of funds is the campaign creator
                // i.e The Wallet that owns the campaignCreatorPubKey
                require(checkSig(claimerSig, campaignCreatorPubKey));

                // 2. This contract must have and must spend atleast 5 utxos,
                // This is like saying atleast 5 must have
                // contributed to the contract.
                require(tx.inputs.length >= 5);

                // 3. Here we calculate the total amount that the campaign creator
                // can claim. We deduct a transaction fee. So the campaign
                // creator can claim the campaign funds even if his/her
                // personal wallet doesn't have any balance.

                int transactionFee = 1000;
                int campaignFunds = campaignGoal - transactionFee;
                
                // 4. Here we are making sure that we hit the campaignGoal - transaction fee.
                // This also makes sure that we are claiming all the funds less transaction fee
                require(tx.outputs[0].value == campaignFunds);
                
                // 6. This ensures that the transaction has only 1 output
                require(tx.outputs.length == 1);

                // 7. Here we are making sure that the funds is sent to the 
                // campaignCreator, to avoid accidentally sending funds to 
                // other address.
                bytes20 campaignCreatorPublicKeyHash = hash160(campaignCreatorPubKey);
                bytes campaignCreatorLockingBytecode = new LockingBytecodeP2PKH(campaignCreatorPublicKeyHash);
                require(tx.outputs[0].lockingBytecode == campaignCreatorLockingBytecode);
            }
        }
    </code>
</section>

<section>
    <h2><div class="text-green-300">Exercise</div></h2>
    <div class="text-center text-2xl">Secret Numbers Contract </div>
    <code lang data-trim>
        pragma cashscript ^0.11.0;
        /**
        * @params {pubkey} owner - 
        * The public key of the owner of this contract.
        *
        * @params {bytes32} secretNumberHash - 
        * The sha256 hash of the absolute difference 
        * of num1 and num2 secret shards. 
        * Hint: 
        *     1. Select two numbers you like (Mind the range, read contract condition)
        *     2. Compute the difference (subtract the numbers)
        *     3. Use online sha256 online hashing tool to get the hash of the difference (Mind the encoding, you are hashing a number, 1 is different from '1')
        *     4. Create the contract, 
        *         Contract parameters: a. A Wallet public key, b. The hash you get from step 3
        *     6. Spend from the contract
        *         Spend parameters: The two numbers you've selected on step 1.
        */        
        contract SecretNumbersDemo(pubkey owner, bytes32 secretNumberHash) {

            function unlockUsingSecretNumbers(int num1, int num2) {
                // Compute min and max of the inputs
                int small = min(num1, num2);
                int big = max(num1, num2);

                // Enforce constraints on min and max
                require(small >= 1, "Min must be at least 1");
                require(big <= 15, "Max must be less than or equal to 15");

                // Compute absolute difference
                int diff = abs(num1 - num2);

                // Require that the hash of the difference matches the committed message hash
                require(sha256(diff) == secretNumberHash, "Hash mismatch");
            }

            function unlockUsingPrivateKey (sig s) {
                require(checkSig(s, owner), "Invalid signature");
            }
        }
    </code>
</section>

<section>
    <h2><div class="text-green-300">Exercise</div></h2>
    <div class="text-center text-2xl">Make a Contract</div>
    <code class="language-javascript">pragma cashscript ^0.11.0;


/*
    A Faucet is a Bitcoin Cash terminology for a server (in our case a contract),
    that users can get BCH from.
 */
contract Faucet(int payout, bytes20 ownerPkhash, bytes passcode) {
    
    function claim (bytes unlockPasscode) {
        /*
            In this exercise, you have to make a Faucet contract that can only spend funds to an address if:
            1. passcode set by the owner is equal to the user input passcode
            2. payout amount is restricted to a certain value only
            3. provide a change output back to the contract if the remaining balance is greater than 546 satoshis (the minimum value for a BCH transaction)
         */
    }

    function ownerUnlock (sig s, pubkey pk) {
        /*
            The owner of this faucet can withdraw funds as needed, but in order to do that, the user
            needs to prove his ownership of this contract
         */
    }

}
    </code>
</section>